# D-REAM Phase 2: Multi-Regime Workload Definitions
version: 2
description: "Defines workload configurations for each domain across idle, normal, stress, and mixed regimes"

domains:
  cpu:
    idle:
      workload: "script"
      args: "scripts/cpu_idle.sh 20"
      description: "Minimal CPU activity baseline (stress-ng disabled)"
    normal:
      workload: "script"
      args: "scripts/cpu_normal.sh 30"
      description: "Standard CPU workload (stress-ng disabled)"
    stress:
      workload: "script"
      args: "scripts/cpu_stress.sh 120"
      description: "CPU stress test (stress-ng disabled)"
    mixed:
      workload: "script"
      args: "scripts/cpu_mixed.sh 90"
      description: "Mixed workload: compute + memory + context switches"

  gpu:
    idle:
      workload: "script"
      args: "scripts/gpu_idle.sh 20"
      description: "GPU idle monitoring"
    normal:
      workload: "script"
      args: "scripts/gpu_infer_short.sh 30"
      description: "Short inference workload"
    stress:
      workload: "script"
      args: "scripts/gpu_matmul_stress.sh 120"
      description: "Matrix multiplication stress test"
    mixed:
      workload: "script"
      args: "scripts/gpu_infer_mixed.sh 90"
      description: "Mixed inference patterns"

  audio:
    idle:
      workload: "script"
      args: "scripts/audio_idle_loop.sh 20"
      description: "Audio device idle monitoring"
    normal:
      workload: "script"
      args: "scripts/audio_loopback_rtl.sh 30"
      description: "Real-time loopback latency test"
    stress:
      workload: "script"
      args: "scripts/audio_burst.sh 120"
      description: "High-throughput audio burst processing"
    mixed:
      workload: "script"
      args: "scripts/audio_full_duplex.sh 60"
      description: "Full-duplex simultaneous I/O"

  memory:
    idle:
      workload: "script"
      args: "scripts/memory_idle.sh 20"
      description: "Minimal memory allocation (stress-ng disabled)"
    normal:
      workload: "script"
      args: "scripts/memory_normal.sh 30"
      description: "Standard memory workload (stress-ng disabled)"
    stress:
      workload: "script"
      args: "scripts/memory_stress.sh 120"
      description: "Memory pressure test (stress-ng disabled)"
    mixed:
      workload: "script"
      args: "scripts/memory_mixed.sh 90"
      description: "Mixed access patterns (sequential + random)"

  storage:
    idle:
      workload: "script"
      args: "scripts/storage_idle.sh 20"
      description: "Storage idle monitoring"
    normal:
      workload: "fio"
      args: "--name=normal_rw --rw=randrw --bs=4k --size=1G --runtime=30 --output-format=json"
      description: "Random read/write mix"
    stress:
      workload: "fio"
      args: "--name=stress_seq --rw=write --bs=1M --size=10G --runtime=120 --output-format=json"
      description: "Sequential write stress"
    mixed:
      workload: "script"
      args: "scripts/storage_mixed.sh 90"
      description: "Mixed I/O patterns"

  asr_tts:
    idle:
      workload: "script"
      args: "scripts/asr_tts_idle.sh 20"
      description: "ASR/TTS pipeline idle"
    normal:
      workload: "script"
      args: "scripts/asr_tts_normal.sh 30"
      description: "Standard speech processing"
    stress:
      workload: "script"
      args: "scripts/asr_tts_stress.sh 120"
      description: "Continuous speech processing"
    mixed:
      workload: "script"
      args: "scripts/asr_tts_mixed.sh 90"
      description: "Mixed ASR + TTS workload"

  power_thermal:
    idle:
      workload: "script"
      args: "scripts/power_idle.sh 20"
      description: "Power monitoring idle"
    normal:
      workload: "script"
      args: "scripts/power_normal.sh 30"
      description: "Normal power consumption"
    stress:
      workload: "script"
      args: "scripts/power_stress.sh 120"
      description: "Maximum power draw test"
    mixed:
      workload: "script"
      args: "scripts/power_mixed.sh 90"
      description: "Variable power load"

  os_scheduler:
    idle:
      workload: "script"
      args: "scripts/scheduler_idle.sh 20"
      description: "Scheduler idle metrics"
    normal:
      workload: "script"
      args: "scripts/scheduler_normal.sh 30"
      description: "Normal context switching"
    stress:
      workload: "script"
      args: "scripts/scheduler_stress.sh 120"
      description: "Heavy context switch stress"
    mixed:
      workload: "script"
      args: "scripts/scheduler_mixed.sh 90"
      description: "Mixed priority workloads"

  conversation:
    idle:
      workload: "script"
      args: "scripts/conversation_idle.sh 20"
      description: "Conversation quality idle"
    normal:
      workload: "script"
      args: "scripts/conversation_normal.sh 30"
      description: "Standard conversation processing"
    stress:
      workload: "script"
      args: "scripts/conversation_stress.sh 120"
      description: "Continuous conversation generation"
    mixed:
      workload: "script"
      args: "scripts/conversation_mixed.sh 90"
      description: "Mixed conversation patterns"

# Regime execution policy
execution:
  default_trials: 10
  trial_delay_seconds: 2
  failure_retry_count: 1
  timeout_multiplier: 1.5

# Metric collection
metrics:
  required: ["perf", "p95_ms", "watts"]
  optional: ["temp_peak_c", "errors", "oom"]
  collection_interval_ms: 100
